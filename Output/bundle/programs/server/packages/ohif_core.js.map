{"version":3,"sources":["meteor://ðŸ’»app/packages/ohif:core/main.js","meteor://ðŸ’»app/packages/ohif:core/both/index.js","meteor://ðŸ’»app/packages/ohif:core/both/schema.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/index.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/object.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getAttribute.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getAuthorizationHeader.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getModalities.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getName.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getNumber.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getString.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/index.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/absoluteUrl.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/index.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/objectPath.js"],"names":["module","export","OHIF","Meteor","watch","require","v","log","ui","utils","viewer","cornerstone","user","DICOMWeb","isClient","window","SimpleSchema","extendOptions","valuesLabels","Match","Optional","String","textOptional","Boolean","addValidator","definition","optional","value","messages","maxCount","minCount","notAllowed","object","getNestedObject","shallowObject","nestedObject","key","hasOwnProperty","propertyArray","split","currentObject","length","currentProperty","shift","getShallowObject","putValues","baseKey","resultObject","currentKey","currentValue","Array","default","getAttribute","element","defaultValue","Value","convertToInt","input","padFour","l","output","i","j","charCodeAt","toString","parseInt","getAuthorizationHeader","btoa","headers","accessToken","getAccessToken","server","servers","getCurrentServer","requestOptions","auth","Authorization","getModalities","modality","modalitiesInStudy","modalities","vr","indexOf","push","getName","Alphabetic","getNumber","parseFloat","getString","join","absoluteUrl","path","absolutePath","absoluteUrlParts","rootUrlPrefixIndex","substring","replace","ObjectPath","set","components","getPathComponents","result","isValidObject","last","field","get","found","isValid","Object"],"mappings":"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","file":"/packages/ohif_core.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\r\n\r\n/*\r\n * Defines the base OHIF object\r\n */\r\n\r\nconst OHIF = {\r\n    log: {},\r\n    ui: {},\r\n    utils: {},\r\n    viewer: {},\r\n    cornerstone: {},\r\n    user: {},\r\n    DICOMWeb: {}, // Temporarily added\r\n};\r\n\r\n// Expose the OHIF object to the client if it is on development mode\r\n// @TODO: remove this after applying namespace to this package\r\nif (Meteor.isClient) {\r\n    window.OHIF = OHIF;\r\n}\r\n\r\nexport { OHIF };\r\n","import './lib';\r\nimport './utils';\r\n\r\nimport './schema.js';\r\n","import { SimpleSchema } from 'meteor/aldeed:simple-schema';\r\n\r\n/*\r\n Extend the available options on schema definitions:\r\n\r\n  * valuesLabels: Used in conjunction with allowedValues to define the text\r\n    label for each value (used on forms)\r\n\r\n  * textOptional: Used to allow empty strings\r\n\r\n */\r\nSimpleSchema.extendOptions({\r\n    valuesLabels: Match.Optional([String]),\r\n    textOptional: Match.Optional(Boolean)\r\n});\r\n\r\n// Add default required validation for empty strings which can be bypassed\r\n// using textOptional=true definition\r\nSimpleSchema.addValidator(function() {\r\n    if (\r\n        this.definition.optional !== true &&\r\n        this.definition.textOptional !== true &&\r\n        this.value === ''\r\n    ) {\r\n        return 'required';\r\n    }\r\n});\r\n\r\n// Including [label] for some messages\r\nSimpleSchema.messages({\r\n    maxCount: '[label] can not have more than [maxCount] values',\r\n    minCount: '[label] must have at least [minCount] values',\r\n    notAllowed: '[label] has an invalid value: \"[value]\"'\r\n});\r\n","import './object.js';\r\nimport './DICOMWeb/';\r\n","import { OHIF } from 'meteor/ohif:core';\r\n\r\nOHIF.object = {};\r\n\r\n// Transforms a shallow object with keys separated by \".\" into a nested object\r\nOHIF.object.getNestedObject = shallowObject => {\r\n    const nestedObject = {};\r\n    for (let key in shallowObject) {\r\n        if (!shallowObject.hasOwnProperty(key)) continue;\r\n        const value = shallowObject[key];\r\n        const propertyArray = key.split('.');\r\n        let currentObject = nestedObject;\r\n        while (propertyArray.length) {\r\n            const currentProperty = propertyArray.shift();\r\n            if (!propertyArray.length) {\r\n                currentObject[currentProperty] = value;\r\n            } else {\r\n                if (!currentObject[currentProperty]) {\r\n                    currentObject[currentProperty] = {};\r\n                }\r\n\r\n                currentObject = currentObject[currentProperty];\r\n            }\r\n        }\r\n    }\r\n\r\n    return nestedObject;\r\n};\r\n\r\n// Transforms a nested object into a shallowObject merging its keys with \".\" character\r\nOHIF.object.getShallowObject = nestedObject => {\r\n    const shallowObject = {};\r\n    const putValues = (baseKey, nestedObject, resultObject) => {\r\n        for (let key in nestedObject) {\r\n            if (!nestedObject.hasOwnProperty(key)) continue;\r\n            let currentKey = baseKey ? `${baseKey}.${key}` : key;\r\n            const currentValue = nestedObject[key];\r\n            if (typeof currentValue === 'object') {\r\n                if (currentValue instanceof Array) {\r\n                    currentKey += '[]';\r\n                }\r\n\r\n                putValues(currentKey, currentValue, resultObject);\r\n            } else {\r\n                resultObject[currentKey] = currentValue;\r\n            }\r\n        }\r\n    };\r\n\r\n    putValues('', nestedObject, shallowObject);\r\n    return shallowObject;\r\n};\r\n","/**\r\n * Returns the specified element as a dicom attribute group/element.\r\n *\r\n * @param element - The group/element of the element (e.g. '00280009')\r\n * @param [defaultValue] - The value to return if the element is not present\r\n * @returns {*}\r\n */\r\nexport default function getAttribute(element, defaultValue) {\r\n    if (!element) {\r\n        return defaultValue;\r\n    }\r\n    // Value is not present if the attribute has a zero length value\r\n    if (!element.Value) {\r\n        return defaultValue;\r\n    }\r\n    // Sanity check to make sure we have at least one entry in the array.\r\n    if (!element.Value.length) {\r\n        return defaultValue;\r\n    }\r\n\r\n    return convertToInt(element.Value);\r\n};\r\n\r\nfunction convertToInt(input) {\r\n    function padFour(input) {\r\n        var l = input.length;\r\n\r\n        if (l == 0) return '0000';\r\n        if (l == 1) return '000' + input;\r\n        if (l == 2) return '00' + input;\r\n        if (l == 3) return '0' + input;\r\n\r\n        return input;\r\n    }\r\n\r\n    var output = '';\r\n    for (var i = 0; i < input.length; i++) {\r\n        for (var j = 0; j < input[i].length; j++) {\r\n            output += padFour(input[i].charCodeAt(j).toString(16));\r\n        }\r\n    }\r\n\r\n    return parseInt(output, 16);\r\n}\r\n","import { OHIF } from 'meteor/ohif:core';\r\nimport { btoa } from 'isomorphic-base64';\r\n\r\n/**\r\n * Returns the Authorization header as part of an Object.\r\n *\r\n * @returns {Object}\r\n */\r\nexport default function getAuthorizationHeader() {\r\n    const headers = {};\r\n\r\n    // Check for OHIF.user since this can also be run on the server\r\n    const accessToken = OHIF.user && OHIF.user.getAccessToken && OHIF.user.getAccessToken();\r\n    const server = OHIF.servers.getCurrentServer();\r\n\r\n    if (server &&\r\n        server.requestOptions &&\r\n        server.requestOptions.auth) {\r\n        // HTTP Basic Auth (user:password)\r\n        headers.Authorization = `Basic ${btoa(server.requestOptions.auth)}`;\r\n    } else if (accessToken) {\r\n        headers.Authorization = `Bearer ${accessToken}`;\r\n    }\r\n\r\n    return headers;\r\n}\r\n","export default function getModalities(modality, modalitiesInStudy) {\r\n    var modalities = {};\r\n    if (modality) {\r\n        modalities = modality;\r\n    }\r\n\r\n    if (modalitiesInStudy) {\r\n        // Find vr in modalities\r\n        if (modalities.vr && modalities.vr === modalitiesInStudy.vr) {\r\n            for (var i = 0; i < modalitiesInStudy.Value.length; i++) {\r\n                var value = modalitiesInStudy.Value[i];\r\n                if (modalities.Value.indexOf(value) === -1) {\r\n                    modalities.Value.push(value);\r\n                }\r\n            }\r\n        } else {\r\n            modalities = modalitiesInStudy;\r\n        }\r\n    }\r\n    return modalities;\r\n};\r\n","/**\r\n * Returns the Alphabetic version of a PN\r\n *\r\n * @param element - The group/element of the element (e.g. '00200013')\r\n * @param [defaultValue] - The default value to return if the element is not found\r\n * @returns {*}\r\n */\r\nexport default function getName(element, defaultValue) {\r\n    if (!element) {\r\n        return defaultValue;\r\n    }\r\n    // Value is not present if the attribute has a zero length value\r\n    if (!element.Value) {\r\n        return defaultValue;\r\n    }\r\n    // Sanity check to make sure we have at least one entry in the array.\r\n    if (!element.Value.length) {\r\n        return defaultValue;\r\n    }\r\n    // Return the Alphabetic component group\r\n    if (element.Value[0].Alphabetic) {\r\n        return element.Value[0].Alphabetic;\r\n    }\r\n    // Orthanc does not return PN properly so this is a temporary workaround\r\n    return element.Value[0];\r\n};\r\n","/**\r\n * Returns the first string value as a Javascript Number\r\n * @param element - The group/element of the element (e.g. '00200013')\r\n * @param [defaultValue] - The default value to return if the element does not exist\r\n * @returns {*}\r\n */\r\nexport default function getNumber(element, defaultValue) {\r\n    if (!element) {\r\n        return defaultValue;\r\n    }\r\n    // Value is not present if the attribute has a zero length value\r\n    if (!element.Value) {\r\n        return defaultValue;\r\n    }\r\n    // Sanity check to make sure we have at least one entry in the array.\r\n    if (!element.Value.length) {\r\n        return defaultValue;\r\n    }\r\n\r\n    return parseFloat(element.Value[0]);\r\n};\r\n","/**\r\n * Returns the specified element as a string.  Multi-valued elements will be separated by a backslash\r\n *\r\n * @param element - The group/element of the element (e.g. '00200013')\r\n * @param [defaultValue] - The value to return if the element is not present\r\n * @returns {*}\r\n */\r\nexport default function getString(element, defaultValue) {\r\n    if (!element) {\r\n        return defaultValue;\r\n    }\r\n    // Value is not present if the attribute has a zero length value\r\n    if (!element.Value) {\r\n        return defaultValue;\r\n    }\r\n    // Sanity check to make sure we have at least one entry in the array.\r\n    if (!element.Value.length) {\r\n        return defaultValue;\r\n    }\r\n    // Join the array together separated by backslash\r\n    // NOTE: Orthanc does not correctly split values into an array so the join is a no-op\r\n    return element.Value.join('\\\\');\r\n};\r\n","import { OHIF } from 'meteor/ohif:core';\r\n\r\nimport getAttribute from './getAttribute.js';\r\nimport getAuthorizationHeader from './getAuthorizationHeader.js';\r\nimport getModalities from './getModalities.js';\r\nimport getName from './getName.js';\r\nimport getNumber from './getNumber.js';\r\nimport getString from './getString.js';\r\n\r\nconst DICOMWeb = {\r\n    getAttribute,\r\n    getAuthorizationHeader,\r\n    getModalities,\r\n    getName,\r\n    getNumber,\r\n    getString,\r\n};\r\n\r\nOHIF.DICOMWeb = DICOMWeb;\r\n","import { OHIF } from 'meteor/ohif:core';\r\n\r\n// Return an absolute URL with the page domain using sub path of ROOT_URL\r\n// to let multiple domains directed to the same server work\r\nOHIF.utils.absoluteUrl = function(path) {\r\n    let absolutePath = '/';\r\n\r\n    const absoluteUrl = Meteor.absoluteUrl();\r\n    const absoluteUrlParts = absoluteUrl.split('/');\r\n\r\n    if (absoluteUrlParts.length > 4) {\r\n        const rootUrlPrefixIndex = absoluteUrl.indexOf(absoluteUrlParts[3]);\r\n        absolutePath += absoluteUrl.substring(rootUrlPrefixIndex) + path;\r\n    } else {\r\n        absolutePath += path;\r\n    }\r\n\r\n    return absolutePath.replace(/\\/\\/+/g, '/');\r\n};\r\n","import './absoluteUrl';\r\nimport './objectPath';\r\n","import { OHIF } from 'meteor/ohif:core';\r\n\r\nclass ObjectPath {\r\n\r\n    /**\r\n     * Set an object property based on \"path\" (namespace) supplied creating\r\n     * ... intermediary objects if they do not exist.\r\n     * @param object {Object} An object where the properties specified on path should be set.\r\n     * @param path {String} A string representing the property to be set, e.g. \"user.study.series.timepoint\".\r\n     * @param value {Any} The value of the property that will be set.\r\n     * @return {Boolean} Returns \"true\" on success, \"false\" if any intermediate component of the supplied path\r\n     * ... is not a valid Object, in which case the property cannot be set. No excpetions are thrown.\r\n     */\r\n    static set(object, path, value) {\r\n\r\n        let components = ObjectPath.getPathComponents(path),\r\n            length = components !== null ? components.length : 0,\r\n            result = false;\r\n\r\n        if (length > 0 && ObjectPath.isValidObject(object)) {\r\n\r\n            let i = 0,\r\n                last = length - 1,\r\n                currentObject = object;\r\n\r\n            while (i < last) {\r\n\r\n                let field = components[i];\r\n\r\n                if (field in currentObject) {\r\n                    if (!ObjectPath.isValidObject(currentObject[field])) {\r\n                        break;\r\n                    }\r\n                } else {\r\n                    currentObject[field] = {};\r\n                }\r\n\r\n                currentObject = currentObject[field];\r\n                i++;\r\n\r\n            }\r\n\r\n            if (i === last) {\r\n                currentObject[components[last]] = value;\r\n                result = true;\r\n            }\r\n\r\n        }\r\n\r\n        return result;\r\n\r\n    }\r\n\r\n    /**\r\n     * Get an object property based on \"path\" (namespace) supplied traversing the object\r\n     * ... tree as necessary.\r\n     * @param object {Object} An object where the properties specified might exist.\r\n     * @param path {String} A string representing the property to be searched for, e.g. \"user.study.series.timepoint\".\r\n     * @return {Any} The value of the property if found. By default, returns the special type \"undefined\".\r\n     */\r\n    static get(object, path) {\r\n\r\n        let found, // undefined by default\r\n            components = ObjectPath.getPathComponents(path),\r\n            length = components !== null ? components.length : 0;\r\n\r\n        if (length > 0 && ObjectPath.isValidObject(object)) {\r\n\r\n            let i = 0,\r\n                last = length - 1,\r\n                currentObject = object;\r\n\r\n            while (i < last) {\r\n\r\n                let field = components[i];\r\n\r\n                const isValid = ObjectPath.isValidObject(currentObject[field]);\r\n                if (field in currentObject && isValid) {\r\n                    currentObject = currentObject[field];\r\n                    i++;\r\n                } else {\r\n                    break;\r\n                }\r\n\r\n            }\r\n\r\n            if (i === last && components[last] in currentObject) {\r\n                found = currentObject[components[last]];\r\n            }\r\n\r\n        }\r\n\r\n        return found;\r\n\r\n    }\r\n\r\n    /**\r\n     * Check if the supplied argument is a real JavaScript Object instance.\r\n     * @param object {Any} The subject to be tested.\r\n     * @return {Boolean} Returns \"true\" if the object is a real Object instance and \"false\" otherwise.\r\n     */\r\n    static isValidObject(object) {\r\n        return (\r\n            typeof object === 'object' &&\r\n            object !== null &&\r\n            object instanceof Object\r\n        );\r\n    }\r\n\r\n    static getPathComponents(path) {\r\n        return (typeof path === 'string' ? path.split('.') : null);\r\n    }\r\n\r\n}\r\n\r\nOHIF.utils.ObjectPath = ObjectPath;\r\n"]}